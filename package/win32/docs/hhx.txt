
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                                                           2007/07/24
  HSP HELP Browser II

  S.Programs 2006-2007
                                         http://sprocket.babyblue.jp/
━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        名称│HSP HELP Browser II
  バージョン│2.17c
    動作環境│Windows 98 / 2000 以降 (IA32)
──────┼────────────────────────────
    必要環境｜HSP 2.61 以降
━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ 概要
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II は、HSP 用のヘルプファイル (hs ファイル) を閲覧す
るためのプログラムです。

IE コンポーネントを用いた HTML ベースのユーザーインターフェイスの採用
により、優れた閲覧性を実現しています。説明文に含まれる命令文などは自動
的にリンクとしてマークアップされ、自由にジャンプができるようになってい
ます。ヘルプの全文検索やスクリプトエディタからのワンキーヘルプにも対応
しています。

hs ファイル エディタも内蔵しており、HSP ヘルプ関連の操作が一通り行える
ようになっています。



■ インストール方法
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP インストールディレクトリにある既存の hsphelp\helpman.exe を、新し
い helpman.exe と置き換え、同じディレクトリに hhx_img ディレクトリをコ
ピーします。

hhx_img ディレクトリには、HSP HELP Browser II が使用するスキンデータ 
(画像ファイル、ヘッダ HTML ファイル) が含まれます。

元の helpman.exe をリネームして残しておくと、アンインストールが簡単に
なります。



■ 使い方
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II を使用するには、HSP スクリプトエディタを起動して 
F1 キーを押すか、helpman.exe を直接起動させます。

このプログラムをはじめて起動させるときは、hs ファイル (ヘルプファイル) 
のデータベース化が行われるため、操作可能になるまで多少時間がかかります。
データベースファイル hhx.db は、プログラムの起動を高速化するために用い
られており、hs ファイルが更新された場合、自動的に再構築されます。hs フ
ァイルは、helpman.exe のあるディレクトリ内のみで検索されます。

画面上部のリンクボタンの役割は、下記にようになります。

・(←) (→)
	ページ移動履歴の 戻る / 進む を行います。
	IE の 戻る/進む 機能に対応するサイドボタンのあるマウスでは、
	そのボタンを利用して移動できます。
	「戻る」のショートカットキーは、BackSpace です。
・Index
	インデックスページへ移動します。
・Find
	検索ボックス内の文字列でページ内検索を行います。
	ショートカットキー : Ctrl-D
	(Ctrl-F で普通のページ内検索ダイアログを出すこともできます。)
・info/option
	バージョン情報を表示します。
	この画面から各種設定変更を行えます。
・close
	プログラムを終了します。(Esc)
・Search
	サイドバーで HSP ヘルプ内のキーワード検索を行います。
	Ctrl-S ショートカットで、検索ボックスにフォーカスします。

検索機能は、スペース区切りでの絞り込み検索に対応しています。頭にマイナ
ス記号 (-) をつけた検索語は、NOT 検索 (含まないものを抽出) されます。
検索結果は、検索キーワードとの適合度が高い順番に表示されます。

HSP HELP Browser II のウィンドウに hs ファイルをドロップすると、hs フ
ァイルライブラリにその hs ファイルをコピーすることができます。



■ 動作環境について
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
初期バージョンの Windows 98 (IE4.0) で動作させるためには、OS コンポー
ネントの更新が必要となります。

インストールするコンポーネント
・DCOM98 (http://www.microsoft.com/japan/com/dcom/dcom98/dcom13.aspx)
・atl.dll (http://activex.microsoft.com/controls/vc/atl.cab)

Windows 95, Windows NT 4.0 およびそれ以前のバージョンの OS は、サポー
ト外となっています。



■ hs ファイルの書式
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II は、同梱の HS_BIBLE.txt の仕様に準拠したヘルプファ
イル (hs ファイル) をサポートします。

この仕様は、原型の HSP HELP Tools もしくは HSP HELP Browser 1.x の仕様
で書かれた hs ファイルに対して上位互換であると共に、より柔軟な書式にも
対応したものとなっています。



■ 内蔵 hs ファイルエディタについて
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II は、hs ファイルエディタを内蔵しています。ヘルプペ
ージ 最下部の、"このレコードを編集..." をクリックすると、
"Help Source Editor" が起動します。

エディタの左ペインがレコード一覧 (シンボル表) で、右ペインが hs ファイ
ル レコードの内容を編集するエディットボックスです。レコード一覧の左側
は、関連項目のリンク状態を表示する欄で、hs ファイル レコードを編集する
とリアルタイムに更新されます。

このエディタでヘルプページを編集して保存すると、HSP HELP Browser II の
ヘルプページも自動的に最新の状態に更新されます。



■ インライン HTML について
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II Version 2.10 から、「解説」項目内で HTML を書くた
めの仕様を追加しました。これは hs ファイルの仕様ではなく、HSP HELP 
Browser II の表示上の仕様です。この機能により、HTML の表現力を hs ファ
イルからフルに利用することができます。

仕様は、%inst フィールド内で "html{" と書いた行から "}html" と書いた行
までの間を、ダイレクトに HTML として表示するというものです。このブロッ
クは、文中に何度出現してもかまいません。

(書式例)
%inst
...
html{
<table border=1>
<tr><th>項目 1</th><th>項目 2</th></tr>
<tr><td>データ 1</td><td>データ 2</td></tr>
<tr><td>データ 3</td><td>データ 4</td></tr>
</table>
}html
...

インライン HTML 機能は、中の HTML の書式チェックなどは行っていません。
誤った HTML が記述されているとページ全体のレイアウトが崩れたりする可能
性もありますので、hs データの配布などを行う場合は十分にチェックを行っ
てください。また、情報の意味づけに関係しない、装飾的な目的での HTML の
使用は避けるようにしてください。

インライン HTML ではアクティブスクリプト (javascript 等) の記述を行わ
ないでください。スクリプトの実行に関するいくつかのキーワードは、使用を
制限されています。インライン HTML で使用した要素のスタイルは、スキンフ
ァイルに記述された CSS の影響を受ける場合があります。



■ カスタマイズ
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II は、スキンファイル (hhx_img\hhx_head.htm) の編集に
より、見栄えやキー操作をカスタマイズできるようになっています。

スキンファイルに書かれた CSS や Javascript の変更により、ヘルプページ
の表示色やフォントサイズ、一部のキー操作を変更できます。

たとえば、標準のショートカットキー (BS, Ctrl-*, Esc) も、スキンファイ
ル内の JavaScript で実装されています。一般的な HTML, CSS, JavaScript
の知識があれば、ある程度のカスタマイズは可能だと思います。



■ アンインストール
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
アンインストールの手順は下記のとおりです。

1. 下記のファイル/ディレクトリを削除する。

	・helpman.exe	プログラム本体
	・hhx.db	データベースファイル
	・hhx.cfg	設定ファイル
	・<hhx_img>	スキンデータを格納したディレクトリ

2. 元の helpman.exe を復元する。

	復元は、HSP 本体のアーカイブやバックアップなどから行います。



■ 著作権フリー
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
HSP HELP Browser II は著作権フリーです。
プログラムの改変や、HSP HELP Browser II のソースを組み込んだプログラム
の公開などに対して、制限は一切ありません。

もし改変したバージョンを公開される場合は、オリジナルとの区別が付くよう
にしてください。



■ リリースノート
￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣
2.17c
・内部動作の改良、その他小変更
・スキンファイルを若干修正

2.17
・オプション設定機能の追加
 - ウィンドウを常に手前に表示する設定の追加
 - リスト デフォルト表示件数の変更に対応
 - サイドバーに履歴を表示する設定の切替に対応
・hs ファイルエディタの更新
 - ボーダーのリサイズに対応
 - レコードの並び順の最適化機能の追加
 - %href ビューで、ファイル外参照の数がわかるよう変更
・インライン HTML の制限キーワードの追加
・スキンファイルの更新
 - 戻る・進むボタンを操作しやすいよう変更

2.15
・hs ファイルエディタを組み込み
・Windows Me でエラーが発生しないよう修正
・インライン HTML でのアクティブスクリプト関係のキーワードの使用を制限

2.12
・アルファベット順インデックス表示機能の追加
・「一覧」, "HOME", "menu" などと呼んでいたページの呼称を Index に統一
・NOT 検索関係の修正
・DB 作成の高速化

2.10a
・アクティブウィンドウ切り替え時の子ウィンドウフォーカスの問題を解消

2.10
・サイドバーの実装
 - 検索結果、表示ページ履歴、検索クエリ履歴をサイドバーに表示
・ヒストリ移動時に、移動元のハイパーリンクがアクティブになるよう変更
・文中に含まれる URL をハイパーリンクに変換するよう変更
・スキンファイルの更新
 - 配色の変更 (軽くシンプルなものに)
 - ページ内検索の実装
 - その他 ショートカットキーの割り当てなど
・検索機能の強化
 - 適合度評価に単語単位のマッチ度を加味
 - NOT 検索に対応
・パフォーマンス改善など
 - 一度生成した検索結果データ等をメモリにキャッシュしてページ切り替えを高速化
 - DB 作成の一部ルーチンのバックグラウンド化
 - DB 圧縮率の向上 (maxslide 16 -> 64)
・TEMP.HTM 無しで動作するモードを追加 (スキンで有効化設定必要)
・リスト表示件数の切り替え方式の変更
・ステータスバーの実装
・インライン HTML をサポート

2.04
・スキンファイルがない状態で動作しない問題を修正 (enbug: 2.03)
・データベースファイルの容量を若干縮小

2.03
・たまにエラー 30 が発生する問題を修正
・ヒストリ移動時にスクロール位置を保持するように変更
・スキンファイル書式のバージョンチェックを実装
・標準スキンファイルの更新
 - Esc キーでの終了操作に対応

2.02
・内部アルゴリズムの変更による省メモリ化

2.01
・全文検索時の適合度評価の精度修正
・(BOM が有る場合) UTF テキストの hs を読み込まないように修正
・その他 速度向上や不具合修正、安定性向上など

2.0
・メニューリストでプラグイン/モジュール別抽出ができるようにした
・サイドボタンのあるマウスで 戻る/進む の操作ができるようにした
・hs ファイルをメモ帳で開く機能を追加
・その他 速度向上や不具合修正など

0.05 (beta)
・ホーム表示状態で、プラグイン・グループ別リストを表示するようにした
・キーワード適合度の順位つきの検索を実装
・デフォルトスキンの更新 (ツールバーの表示位置固定など)
・hs データベース作成の高速化

0.04 (beta)
・hs ファイル仕様の拡張 (おにたまさんの案ベース)
・ヘルプページの見栄えを外部スキンファイルで定義するようにした
・名称を HSP HELP Browser II に決定

0.03 (beta)
・hs ファイル仕様 2.0 (ドラフト) に対応 (HS_BIBLE.txt 参照)
 - 新しいフィールドタグ %port に対応、他
・メインウィンドウへの hs ファイルのドラッグ アンド ドロップに対応
・hs データベース作成の高速化
・hs データベース圧縮機能を実装

0.02 (beta)
・基礎的な機能の実装
 - DB 保存と自動更新
 - ワンキーヘルプ
 - 絞り込み検索
 - ウィンドウ状態保存
 - 複数起動防止
 - ページ内キーワードの自動マークアップ
・Windows 98 (IE4.0) (+ DCOM98 + atl.dll) の環境で動作するよう修正
・ミニ Web ブラウザ機能をテスト実装

0.01
・参考配布版


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
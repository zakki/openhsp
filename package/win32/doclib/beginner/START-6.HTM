<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="ja">	<head>		<meta http-equiv="content-type" content="text/html;charset=euc-jp">		<meta lang="ja" name="keywords" content="HSP,Hot Soup Processor,HSPTV,HSP3,HSP3.0,ONION software,onitama,ホットスープ,プロセッサ,インタプリタ,言語,ＨＳＰ">		<meta name="generator" content="Adobe GoLive">		<title>HSP入門</title>		<link href="main.css" type="text/css" rel="stylesheet" media="all">	</head>	<body onload="preloadImages();" background="images/back6.gif" link="blue" leftmargin="0" marginheight="0" marginwidth="0" topmargin="0">		<div align="center">						<table width="800" border="0" cellspacing="0" cellpadding="0">				<tr>					<td align="left" valign="top" bgcolor="white" width="169">										<br>						<table width="150" border="0" cellspacing="0" cellpadding="0" height="354">							<tr height="30">								<td height="30" background="images/back_menuue.gif">									<p class="leftsubmenu"><a href="COVER.HTM">Start!</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-1.HTM">Step1</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-2.HTM">Step2</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-3.HTM">Step3</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-4.HTM">Step4</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-5.HTM">Step5</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu" style="color:#009999; font-weight:bold;">Step6</p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-7.HTM">Step7</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-8.HTM">Step8</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="START-9.HTM">Final</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_submenu.gif">									<p class="leftsubmenu"><a href="THANKS.HTM">Special thanks</a></p>								</td>							</tr>							<tr height="30">								<td height="30" background="images/back_menusita.gif">									<p class="leftsubmenu"><a href="START.HTM">Cover</a></p>								</td>							</tr>						</table>						<br>					</td>					<td align="left" valign="top" bgcolor="white">						<div class="contents">													<div class="section">								<h2 class="play">step6：これがランチャー?!</h2>								<p>メッセージとボタン、そして画像が表示できるようになりましたが、ま だレイアウトができなくて、ちょっとカッコ悪い画面になってしまいま すね。今度は、そのあたりをちょっと調整してみましょう。 新しく出てくる命令は、</p>								<br>								<img src="images/btn_extention.gif" alt="" height="29" width="29" border="0"><br>								<table width="589" border="0" cellspacing="2" cellpadding="0" bgcolor="#ccffff">									<tr>										<td align="center" bgcolor="#ccffff">											<p>命令(ステートメント)</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>パラメータ</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>意味</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>pos</p>										</td>										<td align="center" bgcolor="white">											<p>X座標,Y座標</p>										</td>										<td align="center" bgcolor="white">											<p>指定した座標をｶﾚﾝﾄﾎﾟｼﾞｼｮﾝに</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>color</p>										</td>										<td align="center" bgcolor="white">											<p>R,G,B輝度値</p>										</td>										<td align="center" bgcolor="white">											<p>テキストの色を指定する</p>										</td>									</tr>								</table>								<br>								<p>です。文字やボタンを表示する時には、必ず画面の左上から出した順番 にタテに並んでしまいますよね。これではレイアウトも何もあったもん じゃありません。実はHSPでは、文字やボタンを表示する位置のことを、カレントポジションと呼んでいます。ワープロソフトなどで、文字を打ち始める位置をカー ソルとかキャレットとか呼んでるのと同じで、HSPではなぜかカレント ポジションから、文字やボタンが表示されるのです。 画面では見えないけども、「ここからボタンや文字を置きますよー」 というカーソルが画面の中にあるんだって思ってください。文字やボタンを表示させた後は、カレントポジションは自動的に次の行 の先頭に移動します。だから、いままではタテに並んでいたんですね。このカレントポジションを変更するのが、「pos」命令です。たとえば、</p><br><table border=0 cellpadding=2 bgcolor="#ffffff"><tr><td>											<p><b>pos</b></p>										</td><td>											<p><b>100,50</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"やっほーー"</b></p>										</td></tr></table>								<br>								<p>のように指定すると、Xの座標が100、Yの座標が50の位置にカレントポ ジションを移動してから、「やっほー」というメッセージを表示さます。 (X,Y)の座標は、左上を(0,0)として1ドット単位になっているから、上の 例だと、左から100ドット目、上から50ドット目に、「やっほー」という 表示がされるのです。同じように、</p>								<br>								<table border=0 cellpadding=2 bgcolor="#ffffff"><tr><td>											<p><b>pos</b></p>										</td><td>											<p><b>30,200</b></p>										</td></tr><tr><td>											<p><b>button</b></p>										</td><td>											<p><b>"OK",*hata1</b></p>										</td></tr></table>								<br>								<p>のように書くと、(30,200)という座標に「OK」と書かれたボタンを表示	します。そして、もう１つ。「pos」命令でカレントポジションを変更	した後は、文字やボタンを表示した後、自動的に次の行の先頭にカレン	トポジションが変更される時に、「pos」命令で指定したX座標にそろえ	られます。つまり、</p>								<br>								<table border=0 cellpadding=2 bgcolor="#ffffff"><tr><td>											<p><b>pos</b></p>										</td><td>											<p><b>50,80</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"1.きょうは"</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"2.いい天気"</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"3.だったよね"</b></p>										</td></tr></table>								<br>								<p>のようなメッセージは、タテにちゃーんと並ぶということ。	さあ、そしてもう1つ命令を覚えましょう。それはたとえば、</p>								<br>								<table border=0 cellpadding=2 bgcolor="#ffffff"><tr><td>											<p><b>cls</b></p>										</td><td>											<p><b>1</b></p>										</td></tr><tr><td>											<p><b>color</b></p>										</td><td>											<p><b>255,0,0</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"赤いよーーー"</b></p>										</td></tr><tr><td>											<p><b>color</b></p>										</td><td>											<p><b>0,0,255</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"青いよーーー"</b></p>										</td></tr></table>								<br>								<p>このように使います。「color」命令は、表示する文字の色を変更する	機能があります。パラメータが3つもあって難しそうに見えますが、コ	ンピュータの画面がR,G,Bという3つの色を合わせて表示しているとい	うことを知っている人には、難しくないと思います。</p>								<br>								<img src="images/btn_extention.gif"><br>								<div class="enroll">									<p>color 赤の輝度値 , 緑の輝度値 , 青の輝度値</p>								</div>								<br>								<p>こんなふうに色を指定します。Windowsでは、最大で1670万色もの色を	出すことができ、それを指定する最も単純な方法がこれなの。	輝度値とは、その成分がどのくらい明るいかということ。0がもっとも	暗くて、255が最も明るい状態になります。どうやって色を指定するの	か、わからない人は、次の設定だけでも覚えておくといいですよ。</p><br>										<table border=0 cellpadding=5 bgcolor="white">											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>0</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 黒</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>0</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 青</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>255</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 赤</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>255</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 紫</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>0</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 緑</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>0</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 水色</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>255</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>,0</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 黄色</b></p>												</td>											</tr>											<tr>												<td bgcolor="white">													<p><b>color</b></p>												</td>												<td bgcolor="white">													<p><b>255</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>,255</b></p>												</td>												<td bgcolor="white">													<p><b>; ← 白</b></p>												</td>											</tr>										</table>								<br>								<p>さて、ここまできたら自由なレイアウトで、好きな画像ファイルを表示	を選んだり、表示したりするスクリプトも書けるようになったはずです。	ここでさらにもう１つ、ランチャーを作るために必要な命令を紹介しま	しょう。</p><br><img src="images/btn_extention.gif" alt="" height="29" width="29" border="0"><br>								<table width="589" border="0" cellspacing="2" cellpadding="0" bgcolor="#ccffff">									<tr>										<td align="center" bgcolor="#ccffff">											<p>命令(ステートメント)</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>パラメータ</p>										</td>										<td align="center" bgcolor="#ccffff">											<p>意味</p>										</td>									</tr>									<tr>										<td align="center" bgcolor="white">											<p>exec</p>										</td>										<td align="center" bgcolor="white">											<p>文字列</p>										</td>										<td align="center" bgcolor="white">											<p>指定したプログラムを実行</p>										</td>									</tr>								</table>								<br><p>ランチャーっていうのは、選んだプログラム（アプリケーション）を	実行するためのメニューみたいなプログラムのこと。ボタン１つで、	Windowsのメモ帳や、計算機が起動しちゃうようなメニユーのことで	す。それを実現してくれるのが、この「exec」命令です。これは、HS	Pから別のプログラム（アプリケーション）を呼びだして起動してし	まう命令です。使い方は簡単、<br>									<br><b>exec "notepad"<br>									</b></p><p><br>									のようにファイル名を指定するだけ。「"notepad"」は正しくは、「	"NOTEPAD.EXE"」ですが、EXEファイルの時はわざわざ書かなくてもOK。	notepad っていうのは、Windowsのメモ帳のこと。「アクセサリ」グル	ープの中にあるアプリケーションです。ボタンを押してジャンプした	先にこの命令を置いておけば、ボタンを押すだけでメモ帳が起動する	ランチャーのできあがり…というわけ。	そして、この命令のもう1つのポイントは、<br>									<br>									<b>exec "notepad HSP2.TXT"</b><br>									<br>										のようにプログラム名の後にスペースを開けてファイル名を指定する	ことで、指定したファイルを開いてくれるということ。上の例では、	メモ帳で「HSP2.TXT」というファイルを開くところまで自動でやって	くれちゃいます。<br><br>注意しなければいけないのは、HSP2.TXTのように開きたいファイル名	を指定する時には、そのファイルがHSP.EXEと同じディレクトリにある	か、またはPATHで指定されているディレクトリになければならないとい	うこと。PATHで指定されているディレクトリとは、普通Windowsのシス	テムが入っているディレクトリなので、Windows標準のシステムツール	であるNOTEPAD.EXE、つまりメモ帳はちゃんと呼び出せる…というわけ。	だから、あとからインストールしたツールとかを呼び出そうとしても	ハードディスクの中から自動的に探してくれるわけじゃないので、	ファイルが見つからない…なんてこともあり得るのです。	<br>									<br>									この命令によって、HSPではできない機能なども外部のプログラムを使 って実現できるようになります。たとえば、音楽集、ムービー集などを 作りたい場合には、<br>									<br>									 <b>exec &quot;mplayer SAMP.AVI&quot;</b><br>									<br>									のように指定すれば、「SAMP.AVI」というAVI動画ファイルがメディア プレイヤーで開いて表示できますし、<br>									<br>									<b>exec &quot;mplayer SAMP.MID&quot;</b><br>									<br>									のように指定すれば、「SAMP.MID」という標準MIDIファイルを簡単に演 奏させることができるようになります。 ほかにも、mp3やwmaなどメディアプレイヤーが再生できるファイルであれば、 何でも指定することができます。 mplayer（メディアプレイヤー）やnotepad（メモ帳）などはWindows標 準のソフトですから、どのWindowsでも起動させることができますが、 標準的でないソフト、たとえばMS-WORDなどといった標準で用意されて いないソフトを起動するスクリプトを作った場合には、その環境以外 では動作しなくなってしまいます。不特定多数の人に配布するスクリ プトを作る時などは注意してくださいね。<br>									<br>									最後に簡単なスクリプトの例を紹介して、このパートはおしまい。 ボタンとラベルの使い方をバッチリマスターしてから 次に進んでね。<br>									</p><br><table border=0 cellpadding=0 bgcolor="#ffffff"><tr><td>											<p><b>cls</b></p>										</td><td>											<p><b>1</b></p>										</td></tr><tr><td>											<p><b>pos</b></p>										</td><td>											<p><b>100,50</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"計算機"</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"メモ帳"</b></p>										</td></tr><tr><td>											<p><b>mes</b></p>										</td><td>											<p><b>"おしまい"</b></p>										</td></tr><tr><td>											<p><b>pos</b></p>										</td><td>											<p><b>20,50</b></p>										</td></tr><tr><td>											<p><b>button</b></p>										</td><td>											<p><b>"CALC",*mkcalc</b></p>										</td></tr><tr><td>											<p><b>button</b></p>										</td><td>											<p><b>"MEMO",*mkmemo</b></p>										</td></tr><tr><td>											<p><b>button</b></p>										</td><td>											<p><b>"END",*owari</b></p>										</td></tr><tr>										<td>											<p><b>stop</b></p>										</td>									</tr><tr><td>											<p>																							</p>										</td><td>											<p><b>*mkcalc</b></p>										</td></tr><tr><td>											<p><b>exec</b></p>										</td><td>											<p><b>"calc"</b></p>										</td></tr><tr>										<td>											<p><b>stop</b></p>										</td>									</tr><tr><td>											<p>																							</p>										</td><td>											<p><b>*mkmemo</b></p>										</td></tr><tr><td>											<p><b>exec</b></p>										</td><td>											<p><b>"notepad"</b></p>										</td></tr><tr>										<td>											<p><b>stop</b></p>										</td>									</tr><tr><td>											<p>																							</p>										</td><td>											<p><b>*owari</b></p>										</td></tr><tr>										<td>											<p><b>end</b></p>										</td>									</tr></table></div>							<div class="section">								<table>									<tr>										<td><a href="START-7.HTM"><img src="images/btn_next.gif" alt="" height="29" width="29" border="0"></a></td>										<td><font size="-1"><a href="START-7.HTM">step7：変数を使ってみよう</a></font></td>									</tr>								</table>							</div>						</div>					</td>				</tr>			</table>															<div align="center">			<table width="800" border="0" cellspacing="0" cellpadding="0">					<tr>					<td align="center">							<p style="color:#333333; font-size:10px; margin:5px 0px">ONION software Copyright 1997-2007(c) All rights reserved.<br>							</p>						</td>				</tr>				</table>		</div></div>	</body></html>
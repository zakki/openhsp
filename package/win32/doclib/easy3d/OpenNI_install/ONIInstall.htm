<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS"><H1>OpenNIのインストール</H1>
<Br>
<Br>
　キネコデラックスを利用する前に、OpenNIのインストールが必要です。<Br>
OpenNIとは、パソコンからKinectを利用するためのソフトウェアです。<Br>

<Br><Br><Br>

<H2>インストール手順</H2>

<H3>（１） OpenNI binariesをダウンロードします</H3>
<A Href="http://www.openni.org/">http://www.openni.org/</A> にアクセスし、<Br>
Downloadsをクリックします。<Br><Br>
<Img Src="image/openNI_1.png" Width="953" Height="465" Border='1'><Br><Br><Br><Br><Br>

さらに、「OpenNI Binaries」へと進み、<Br><Br>
<Img Src="image/openNI_2.png" Width="726" Height="551" Border='1'><Br><Br><Br><Br><Br>

さらに、「Stable」をクリックします。<Br><Br>
<Img Src="image/openNI_3.png" Border='1'><Br><Br><Br><Br><Br>

ここで、32bit OSの方は、「OpenNI Stable Build for Windows x86 (32-bit) v1.1.0.38 Redist Edition」 を、<Br>
64bit OSの方は、「OpenNI Stable Build for Windows x64 (64-bit) v1.1.0.38 Redist Edition」 をダウンロードしてください。<Br>
OSが32bitか64bitかを調べる方法は、<A href="html/OS_bit.htm">こちら</A>をご参照ください。<Br><Br>

<Img Src="image/openNI_4.png" Border="1" Width="743" Height="725">

<Br><Br><Br><Br>

<H3>（２）NITEをダウンロードします</H3>
<A Href="http://www.openni.org/">http://www.openni.org/</A> にアクセスし、<Br>
（１）OpenNI binariesのときと同様、Downloadsをクリックします。<Br><Br>

さらに、「OpenNI Compliant Middleware Binaries」→「Stable」と進みます。<Br>
このとき、下図の四角で囲んであるキーをメモしておいてください。（後でインストールに使用します）<Br><Br>
<Img Src="image/NITE_1.png" Border="1" Width="729" Height="493"><Br><Br><Br>


さらに、32bit OSの方は、「PrimeSense NITE Stable Build for Windows x86 (32-bit) v1.3.1.3 Redist Edition」 を、<Br>
64bit OSの方は、「PrimeSense NITE Stable Build for Windows x64 (64-bit) v1.3.1.3 Redist Edition」 をダウンロードしてください。<Br>
<Br><Br><Br>

<H3>（３）OpenNI Kinect Sensor Driver for Windows をダウンロードします</H3>

<A Href="https://github.com/avin2/SensorKinect">https://github.com/avin2/SensorKinect</A> にアクセスし、Downloadをクリックします。<Br>
すると、ウィンドウが表示されますので、Download .zipを選択してください。<Br><Br>

<Img Src="image/Driver_1.png" Border="1" Width="993" Height="538"><Br><Br><Br>

ダウンロードしたファイルは解凍しておきます。<Br><Br><Br>
<Br>

<H3>（４）ドライバーをインストールします</H3>

<Font Color="red">※ OpenKinectのドライバをインストールされている方は，事前にアンインストールしておきます．<Br> 
　OpenKinectは、OpenNIとドライバが競合しています。OpenKinectのインストールなどを行ったことがない方は、<Br>
　特に問題ありません。<Br>
※ UAC関連でインストールなどが出来ない場合は一時的にUACをOFFにします． <Br>
　 [コントロールパネル]&gt;[ユーザーアカウント]&gt;[ユーザーアカウント制御設定の変更]と進み， <Br>
　 スライダーを一番下まで下げ，Windowsを再起動することでUACをOFFにできます．<Br><Br><Br></Font>


PCにKinectを接続します。<Br>
<Font Color="red">※Kinectは、USBでPCに接続しますが、新しいタイプのKinectは、コネクタがUSBではないので、<Br>
変換ケーブルが必要です。変換ケーブルの購入手順は<A href="html/Kinect_USB.htm">こちら</A>をご参照ください。<Br></Font>
<Br><Br>

接続すると、デバイスドライバのインストールが自動で始まりますが、<Br>
下図のように、インストールに失敗します。<Br><Br>

<Img Src="image/Driver_2.png" Border="1" Width="824" Height="129"><Br><Br><Br><Br>

[コントロールパネル]から[デバイスマネージャー]を開きます． <Br><Br>
すると、“ほかのデバイス”のツリーに“Xbox NUI Motor”が「！」がついた状態で存在していますので、<Br>
これを右クリックし、「ドライバーソフトウェアの更新」を選択します。<Br><Br><Br>

<Img Src="image/Driver_3.png" Border="1"><Br><Br><Br><Br>
<Img Src="image/Driver_4.png" Border="1" Width="491" Height="559"><Br><Br><Br><Br>


すると，どのような方法でインストールするか問われるので，<Br>
下側にある“コンピュータを参照してドライバーソフトウェアを検索します”を選びます．<Br><Br>   

<Img Src="image/Driver_5.png" Border="1"><Br><Br><Br><Br>


次にドライバの場所を聞いてくるので，<Br>
（３）でダウンロードしたファイルの中にあるドライバの場所を指定します．<Br> 
ドライバの場所は以下の通りです。<Br><Br>

<Font Color="red">[（３）で解凍したフォルダ]\avin2-SensorKinect-<u>28738dc</u>\Platform\Win32\Driver <Br>
※ただし、下線部はバージョンによって異なります。</Font><Br><Br>


“サブフォルダーも検索する”にチェックを入れておきましょう． <Br>
 指定したら“次へ”を押してインストールを開始します． <Br><Br><Br>

<Img Src="image/Driver_6.png" Border="1"><Br><Br><Br><Br>

Windowsセキュリティが以下のような画面を出した場合、<Br>
下の選択肢を選択します。<Br>
これは、ドライバがMicrosoftの署名を受けていないために表示される画面です。<Br>
<Br><Br>
<Img Src="image/Driver_7.png" Border="1"><Br><Br><Br><Br>


インストールが完了すると、デバイスマネージャの表示が変わり、<Br>
"PrimeSensor"の中に、<Br>
"Kinect Audio", "Kinect Camera", "Kinect Motor"<Br>
の３つが表示されます。<Br><Br>
<Img Src="image/Driver_8.png" Border="1"><Br><Br><Br><Br>
<Br><Br>

<H3>（５）OpenNIをインストールします</H3>

（１）でダウンロードしたOpenNIのインストーラ(OpenNI-<u>Win32-1.1.0.38</u>-Redist.exe)を実行してインストールします． <Br>
※下線部は、バージョンやOSによって異なります。<Br><Br>

ダイアログに沿ってインストールを行って下さい。<Br><Br><Br><Br><Br>

<H3>（６）PrimeSensor for Windows(Kinect Mod)をインストールします</H3>

（３）でダウンロードしたフォルダの中にある、”SensorKinect-Win-OpenSource32-5.0.1.msi”を実行します。<Br><Br>
<Font Color="red">[（３）で解凍したフォルダ]\avin2-SensorKinect-<u>28738dc</u>\Bin\SensorKinect-Win-OpenSource<u>32-5.0.1</u>.msi <Br>
※ただし、下線部はバージョンやOSによって異なります。</Font><Br><Br><Br>

通常は、ダイアログに沿ってインストールを行いますが、<Br>
バージョンによっては以下のようなエラーが出ることがあります。<Br>
これは、ドライバが想定しているよりも、OpenNIのバージョンが古い場合に表示されます。<Br><Br><Br>
<Img Src="image/Driver_9.png" Border="1"><Br><Br>
上記の場合、OpenNIのバージョンが1.1.0.39以上でないといけないことを表しています。
<Br><Br><Br><Br>

この場合は、手順（１）のOpenNIのダウンロードにおいて、<Br>
”Stable”を選択していたところで、代わりにLatest Unstableを選択し、<Br>
先ほどエラーで表示されたバージョンより新しいバージョンのOpenNIをダウンロードし、<Br>
インストールしてください。<Br><Br>

<Img Src="image/Driver_10.png" Border="1"><Br><Br><Br><Br>
<Img Src="image/Driver_11.png" Border="1"><Br><Br><Br><Br>

その後、再度、”SensorKinect-Win-OpenSource32-5.0.1.msi”を実行します。<Br><Br><Br><Br><Br>


<H3>（７）NITEをインストールします</H3>

（２）でダウンロードした”NITE-Win<u>32-1.3.1.3</u>-Redist.msi”を実行します。<Br>
※下線部は、OSやバージョンによって異なります。<Br><Br>

途中でライセンスキーを求められるので，（２）でメモしておいたキーを入力してインストールを進めます． <Br><Br>

<Img Src="image/NITE_I1.png" Border="1" Width="509" Height="398"><Br><Br><Br><Br><Br>


以上で、OpenNIのインストールが完了し、Kinectによるキャプチャが可能になりました。<Br>
お疲れ様でした。<Br><Br><Br><Br><Br>

【参考URL】<Br>
まとめ？ブログ様<Br>
http://kgxpx834.blog58.fc2.com/blog-entry-22.html<Br><Br><Br><Br><Br>


